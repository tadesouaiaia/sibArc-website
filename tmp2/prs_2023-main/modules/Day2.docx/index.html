<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Tade Souaiaia" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>Introduction to Polygenic Risk Scores - SibArc</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link href="../../../../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Introduction to Polygenic Risk Scores";
        var mkdocs_page_input_path = "tmp2/prs_2023-main/modules/Day2.docx.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> SibArc
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Quick Start</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../quik_install/">Installation and Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../quik_demo/">Running SibArc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../quik_result/">Interpreting Results</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../about_future/">Future Work</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../tmp/workshop_practical_paul.docx/">Day 1 (AM)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../tmp/workshop_practical_tade/">Day 1 (PM)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../workshop_practical_clive.docx/">Day 2 (AM)</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">SibArc</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Introduction to Polygenic Risk Scores</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tadesouaiaia/sibArc-website/edit/master/docs/tmp2/prs_2023-main/modules/Day2.docx.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction-to-polygenic-risk-scores">Introduction to Polygenic Risk Scores</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#key-learning-outcomes">Key Learning Outcomes</a></li>
<li><a href="#resources-you-will-be-using">Resources you will be using</a></li>
<li><a href="#data-structure">Data Structure</a> </li>
<li><a href="#introduction">Introduction</a> </li>
<li><a href="#understanding-gwas-summary-statistics">Understanding GWAS Summary Statistics</a> </li>
<li><a href="#matching-the-base-and-target-data-sets">Matching the Base and Target Data sets</a> </li>
<li><a href="#linkage-disequilibrium-in-prs-analyses">Linkage Disequilibrium in PRS Analyses</a> <ol>
<li><a href="#performing-clumping">Performing Clumping</a> </li>
</ol>
</li>
<li><a href="#p-value-thresholding">P-Value Thresholding</a> <ol>
<li><a href="#height-prs-using-gw-significant-snps-only">Height PRS using GW-significant SNPs
        only</a> </li>
<li><a href="#height-prs-across-multiple-p-value-thresholds">Height PRS across multiple P-value
        thresholds</a>   </li>
<li><a href="#high-resolution-scoring">High Resolution Scoring</a></li>
</ol>
</li>
<li><a href="#stratifying-samples-by-prs">Stratifying Samples by PRS</a> </li>
<li><a href="#case-control-studies">Case Control Studies</a> </li>
<li><a href="#cross-trait-analysis">Cross-Trait Analysis</a></li>
</ol>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="key-learning-outcomes">Key Learning Outcomes</h2>
<p>After completing this practical, you should be able to:</p>
<ol>
<li>Perform basic Polygenic Risk Score (PRS) analyses using PRSice:
    (<a href="https://doi:10.1093/bioinformatics/btu848">Euesden, Lewis &amp; O'Reilly 2015</a>;<a href="https://doi:10.1093/gigascience/giz082">Choi &amp; O'Reilly 2019</a>)</li>
<li>Interpret results generated from PRS analyses</li>
<li>Customise visualisation of results</li>
</ol>
<h2 id="resources-you-will-be-using">Resources you will be using</h2>
<p>To perform PRS analyses, summary statistics from Genome-Wide Association Studies (GWAS) are required. In this workshop, the following summary statistics are used:</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><strong>Phenotype</strong></th>
<th style="text-align: center;"><strong>Provider</strong></th>
<th style="text-align: center;"><strong>Description</strong></th>
<th style="text-align: center;"><strong>Download Link</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Height</td>
<td style="text-align: center;"><a href="https://portals.broadinstitute.org/collaboration/giant/index.php/GIANTconsortium_data_files">GIANT Consortium</a></td>
<td style="text-align: center;">GWAS of height on 253,288 individuals</td>
<td style="text-align: center;"><a href="https://portals.broadinstitute.org/collaboration/giant/images/0/01/GIANT_HEIGHT_Wood_et_al_2014_publicrelease_HapMapCeuFreq.txt.gz">Link</a></td>
</tr>
<tr>
<td style="text-align: center;">Coronary artery disease (CAD)</td>
<td style="text-align: center;"><a href="http://www.cardiogramplusc4d.org/">CARDIoGRAMplusC4D Consortium</a></td>
<td style="text-align: center;">GWAS on 60,801 CAD cases and 123,504 controls</td>
<td style="text-align: center;"><a href="http://www.cardiogramplusc4d.org/media/cardiogramplusc4d-consortium/data-downloads/cad.additive.Oct2015.pub.zip">Link</a></td>
</tr>
</tbody>
</table>
<h2 id="data-structure">Data Structure</h2>
<p>You will find all practical materials in the <strong>/home/manager/data/Day2_Target_Data/Day2_Target_Data</strong> directory. Relevant materials that you should see there at the start of the practical are as follows:</p>
<blockquote>
<p>First, download the Base datasets using this <a href="https://www.dropbox.com/s/w7g75bo069tupuq/Day2_Base_Data.zip?dl=0">link</a>.
The data will be downloaded into your "Downloads" folder. You will need to move it to right directory, using the following command.
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>cd ~/data/Day2_Target_Data/Day2_Target_Data
</code></pre></div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>mv ~/Downloads/Day2_Base_Data.zip ~/data/Day2_Target_Data/Day2_Target_Data
</code></pre></div>
Now, your Day2_Base_dat.zip has been moved to your Day2_Target_Data directory. However, the file is zipped so you will need to unzip it:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>unzip Day2_Base_Data.zip
</code></pre></div></p>
<p>For clarity purposes, rename your Day2_Base_data to Base_data and make a directory for your Target data called "Target_data" in which you will move all your target datasets.
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>mv Day2_Base_Data Base_Data
</code></pre></div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>mkdir Target_Data
</code></pre></div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>mv TAR.* Target_Data
</code></pre></div></p>
<p>You also want to create a "Results" directory where all your results will be saved
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>mkdir Results
</code></pre></div>
So now in your current working directory (for Day2), you should have 3 directories (in blue) called Base_data, Target_data, and Results
</p>
</blockquote>
<p>ğŸ“‚: Base_Data</p>
<ul>
<li>GIANT_Height.txt,</li>
<li>cad.add.txt,</li>
<li>cad.add.readme.</li>
</ul>
<p>ğŸ“‚: Target_Data
  - TAR.fam
  - TAR.bim
  - TAR.bed
  - TAR.height
  - TAR.cad 
  - TAR.covariate</p>
<p>ğŸ› ï¸: Software
  - plink_mac
  - plink_linux
  - plink.exe
  - PRSice.R 
  - PRSice_mac
  - PRSice_linux
  - PRSice_win64.exe</p>
<hr />
<blockquote>
<p>â€¼ï¸ All target phenotype data in this worshop are <strong>simulated</strong>. They have no specific biological meaning and are for demonstration purposes only. 
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="introduction">Introduction</h2>
<p>A PRS is a (usually weak) estimate of an individual's genetic propensity to a phenotype, calculated as a sum of their genome-wide genotypes weighted by corresponding genotype effect sizes obtained from GWAS summary statistics. In the next section we will consider what the effect size means and how it is used in computing PRS.</p>
<h2 id="understanding-gwas-summary-statistics">Understanding GWAS Summary Statistics</h2>
<p>When GWAS are performed on a quantitative trait, the effect size is
 typically given as a beta coefficient (ğ›½) from a linear regression
 with Single Nucleotide Polymorphism (SNP) genotypes as predictor of
 phenotype. The ğ›½ coefficient estimates the increase in the phenotype
for each copy of the <em>effect allele</em>. For example, if the effect
 allele of a SNP is <strong>G</strong> and the non-effect allele is <strong>A</strong> , then the
 genotypes <strong>AA</strong>, <strong>AG</strong> and <strong>GG</strong> will be coded as 0, 1 and 2
 respectively. In this scenario, the ğ›½ coefficient reflects how much
 the phenotype changes for each <strong>G</strong> allele present (NB. The ğ›½ can be
 positive or negative - so the 'effect allele' is simply the allele
 that was coded in the regression, not necessarily the allele with a
 positive effect).</p>
<p>When a GWAS is performed on a binary trait (e.g. case-control study),
 the effect size is usually reported as an Odd Ratios (OR). Using the
 same example, if the OR from the GWAS is 2 with respect to the <strong>G</strong>
 allele, then the OR of <strong>AG</strong> relative to <strong>AA</strong> is 2, and the OR of
 <strong>GG</strong> relative to <strong>AA</strong> is 4. So an individual with the <strong>GG</strong>
 genotype are estimated* to be 4 times more likely to be a case than
 someone with the <strong>AA</strong> genotype (*an Odds Ratio is itself an
 estimate of a Risk Ratio, which cannot be calculated from a
 case/control study)</p>
<hr />
<blockquote>
<p>ğŸ“œ The relationship between the ğ›½ coefficient from the logistic regression and the OR is: 
<strong>OR = <em>e</em><sup>ğ›½</sup></strong> and 
<strong>log<sub><em>e</em></sub>(OR)</strong> <strong>=</strong> ğ›½.</p>
<p>While GWAS usually convert from the ğ›½ to the OR when reporting results, most PRS software convert OR back to ğ›½'s(ğ‘™ğ‘œğ‘”<sub>ğ‘’</sub>(ğ‘‚ğ‘…)) to allow simple addition.</p>
<p>ğŸ“œ Column names are not standardised across reported GWAS results, thus it is important to check which column is the effect (coded) allele and which is the non-effect allele. For example, in the height GWAS conducted by the GIANT consortium, the effect allele is in the column Allele1, while Allele2 represents the non-effect allele.
</p>
</blockquote>
<hr />
<blockquote>
<p>ğŸ” Let us open the Height GWAS file (<strong>GIANT_Height.txt</strong>) and inspect the SNPs at the top of the file. If we only consider SNPs <em>rs4747841</em> and <em>rs878177</em>, what will the â€˜PRSâ€™ of an individual with genotypes <strong>AA</strong> and <strong>TC</strong>, respectively, be? And what about for an individual with <strong>AG</strong> and <strong>CC</strong>, respectively? (Careful these are not easy to get correct! This shows how careful PRS algorithms/code need to be).
<details>
  <summary>Answer</summary>     </p>
<p>In the GIANT_Height.txt, SNPs effect sizes are reported as ğ›½ coefficient and measures the effect of the 'effect allele'. So, first check identify which allele is the effect allele for the SNPs of interest
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>grep -E &#39;rs4747841|rs878177&#39; ./Base_data/GIANT_Height.txt
</code></pre></div>
rs4747841 A G 0.551 -0.0011 0.0029 0.7 253213</p>
<p>rs878177 T C 0.3 0.14 0.0031 8.2e-06 251271      </p>
<p>Second, multiply the weight of each risk allele by their dosage   <br />
Individual_1: PRS=?,<br />
Individual_2: PRS=?</p>
</details>
</blockquote>
<hr />
<blockquote>
<p>â“What do these PRS values mean in terms of the height of those individuals?
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="matching-the-base-and-target-data-sets">Matching the Base and Target Data sets</h2>
<p>The first step in PRS calculation is to ensure consistency between the GWAS summary statistic file (<em>base data</em>) and the target genotype file (<em>target data</em>). Since the base and target data are generated independently, they often relate to different SNPs and so the first job is to identify the overlapping SNPs across the two data sets and remove non-overlapping SNPs (this is usually done for you by PRS software). If the overlap is low then it would be a good idea to perform imputation on your target data to increase the number of SNPs that overlap between the data sets.</p>
<p>The next, more tricky issue, is that the genotype encoding between the data sets may differ. For example, while the effect allele of a SNP is <strong>T</strong> in the base data, the effect allele in the target might be <strong>G</strong> instead. When this occurs, <em>allele flipping</em> should be performed,where the genotype encoding in the target data is reversed so that <strong>TT</strong>, <strong>TG</strong> and <strong>GG</strong> are coded as 2, 1 and 0. Again, this is usually performed automatically by PRS software.</p>
<hr />
<blockquote>
<p>â€¼ï¸For SNPs that have complementary alleles, e.g. <strong>A/T</strong>, <strong>G/C</strong>, we cannot be certain that the alleles referred to in the target data correspond to those of the base data or whether they are the 'other way around' due to being on the other DNA strand (unless the same genotyping chip was used for all data). These SNPs are known as <strong><em>ambiguous SNPs</em></strong>, and while allele frequency information can be used to match the alleles, we remove ambiguous SNPs in PRSice to avoid the possibility of introducting unknown bias.
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="linkage-disequilibrium-in-prs-analyses">Linkage Disequilibrium in PRS Analyses</h2>
<p>GWAS are typically performed one-SNP-at-a-time, which, combined with the strong correlation structure across the genome (Linkage Disequilibrium (LD)), makes identifying the independent genetic effects (or their best proxies if these are not genotyped/imputed) challenging. There are two main options for approximating the PRS that would have been generated from full conditional GWAS: 1. SNPs are <em>clumped</em> so that the retained SNPs are largely independent of each other, allowing their effects to be summed, assuming additive effects, 2. all SNPs are included and the LD between them is accounted for.</p>
<p>While option 2 is statistically appealing, option 1 has been most adopted in PRS studies so far, most likely due to its simplicity and the similarity of results of methods using the different options to date (<a href="https://doi.org/10.1002/gepi.22050"><strong>Mak, T et al., 2017</strong></a>). In this workshop we will consider option 1, implemented in PRSice, but if you are interested in how LD can be incorporated as a parameter in PRS calculation then see the LDpred (<a href="https://doi.org/10.1016/j.ajhg.2015.09.001"><strong>Vilhjalmsson, B et al., 2015</strong></a>)and lassosum (<a href="https://doi.org/10.1002/gepi.22050"><strong>Mak, T et al., 2017</strong></a>) papers.</p>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h3 id="performing-clumping">Performing Clumping</h3>
<p><em>Clumping</em> is the procedure where a SNP data set is 'thinned' by removing SNPs across the genome that are correlated (in high LD) with a nearby SNP that has a smaller association ğ‘ƒ -value. </p>
<p>SNPs are first sorted (i.e. ranked) by their ğ‘ƒ -values. Then, starting from the most significant SNP (denoted as the <em>index SNP</em>), any SNPs in high LD (eg. ğ‘Ÿ<sup>2</sup>&gt;0.1, with ğ‘Ÿ<sup>2</sup> typically calculated from <em>phased haplotype</em> data) with the index SNP are removed. To reduce computational burden, only SNPs that are within e.g. 250 kb of the <em>index SNP</em> are ğ‘ğ‘™ğ‘¢ğ‘šğ‘ğ‘’ğ‘‘. This process is continued until no <em>index SNPs</em> remain.</p>
<p>Use the command below to perform clumping of the Height GWAS data using PLINK(<a href="https://doi.org/10.1186/s13742-015-0047-8"><strong>Chang, C et al., 2015</strong></a>). First, you will have to navigate to the right folder where the data are stored using the terminal. Open the terminal and type the command below at the terminal prompt:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>  plink \
  --bfile Target_Data/TAR \
  --clump Base_Data/GIANT_Height.txt \
  --clump-p1 1 \
  --clump-snp-field MarkerName \
  --clump-field p \
  --clump-kb 250 \
  --clump-r2 0.1 \
  --out Results/Height
</code></pre></div></p>
<hr />
<blockquote>
<p>â€¼ï¸You can copy &amp; paste code from this document directly to the terminal, but this can cause problems (e.g. when opened by Preview in Mac) and distort the code. Try using Adobe Reader or first copy &amp; pasting to a text editor (e.g. notepad) or use the script file provided that contains all the commands.
</p>
</blockquote>
<hr />
<p>The command above performs clumping on the height GWAS using LD calculated based on the <strong>TAR</strong> genotype file. SNPs that have ğ‘Ÿ<sup>2</sup>&gt;0.1 within a 250 kb window of the index SNP are removed. This will generate the <strong>Height.clumped</strong> file, which contains the SNPs retained after clumping.</p>
<hr />
<blockquote>
<p>â“How many SNPs were in the GIANT_Height.txt file before clumping?
<details>
<summary>Answer</summary>     </p>
<p>2,183,049 variants     </p>
</details>
<p>â“How many SNPs remain after clumbing?
<details>
<summary>Answer</summary>     </p>
<p>109,496 variants     </p>
</details>
<p>â“If we change the r<sup>2</sup> threshold to 0.2, how many SNPs remain? Why are there, now, more SNPs remaining?
<details>
<summary>Answer</summary>     </p>
<p>162,275 variants     </p>
</details>
<p>â“Why is clumping performed for calculation of PRS? (in the standard approach).
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="p-value-thresholding">P-Value Thresholding</h2>
<p>Deciding which SNPs to include in the calculation of PRS is one of the major challenges in the field. A simple and popular approach is to include SNPs according to their GWAS association ğ‘ƒ-value. For example, we may choose to include only the genome-wide significant SNPs from the GWAS because those are the SNPs with significant evidence for association. In the next subsection you will compute PRS from GW-significant SNPs only, and then in the subsequent subsection you will generate multiple PRSs using different ğ‘ƒ-value thresholds.</p>
<h3 id="height-prs-using-gw-significant-snps-only">Height PRS using GW-significant SNPs only</h3>
<p>Use the commands below to run PRSice with GIANT Height GWAS as base data and the height phenotype as target data. PRSice will calculate Height PRS in the target data and then perform a regression of the Height PRS against the target individual's true height values. From the <strong>/home/manager/data/Day2_Target_Data/Day2_Target_Data</strong> directory, run the following command in the terminal:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --bar-levels 5e-8 --no-full --fastscore --out Results/Height.gws
</code></pre></div></p>
<p>This command takes the Height GWAS summary statistic file (--base), informs PRSice of the column name for the column containing the SNP ID(--snp), the effect allele (--A1), the non-effect allele (--A2),the effect size (--stat) and the ğ‘ƒ-value (--pvalue). We also inform PRSice that the effect size is a ğ›½ coefficient (--beta) instead of an OR. The --binary-target F command informs PRSice that the target phenotype is a quantitative trait and thus linear regression should be performed. In addition, we ask PRSice not to perform high-resolution scoring over multiple thresholds (--fastscore), and to compute the PRS using only those SNPs with ğ‘ƒ-value \&lt; 5*Ã—*10<sup>âˆ’8</sup>.</p>
<hr />
<blockquote>
<p>ğŸ“œThe default of PRSice is to perform clumping with r<sup>2</sup> threshold of 0.1 and a window size of 250kb.</p>
<p>To see a full list of command line options available in PRSice, type: </p>
<p><code>~/PRSice/PRSice_linux -h</code></p>
<p>Take some time to have a look through some of these user options. By looking at the user options, work out which user option or options were used to ensure that the command above only calculated 1 PRS at genome-wide significance of \&lt; 5*Ã—*10<sup>âˆ’8</sup>.
</p>
</blockquote>
<hr />
<p>PRSice performs strand flipping and clumping automatically and generates the <strong>Height.gws.summary</strong> file, together with other output that we will look into later in the practical. The summary file contains the following columns:</p>
<ol>
<li><strong>Phenotype</strong> - Name of Phenotype.</li>
<li><strong>Set</strong> - Name of Gene Set. Default is <em>Base</em></li>
<li><strong>Threshold</strong> - Best P-value Threshold</li>
<li><strong>PRS.R2</strong> - Variance explained by the PRS</li>
<li><strong>Full.R2</strong> - Variance explained by the full model (including the covariates)</li>
<li><strong>Null.R2</strong> - Variance explained by the covariates (none provided here)</li>
<li><strong>Prevalence</strong> - The population disease prevalence as indicated by the user (not provided here due to testing continuous trait)</li>
<li><strong>Coefficient</strong> - The ğ›½ coefficient corresponding to the effect estimate of the best-fit PRS on the target trait in the regression. A one unit increase in the PRS increases the outcome by ğ›½</li>
<li><strong>Standard.Error</strong> - The standard error of the best-fit PRS ğ›½ coefficient (see above)</li>
<li><strong>P</strong> - The ğ‘ƒ -value relating to testing the null hypothesis that the best-fit PRS ğ›½ coefficient is zero.</li>
<li><strong>Num_SNP</strong> - Number of SNPs included in the best-fit PRS</li>
<li><strong>Empirical-P</strong> - Only provided if permutation is performed. This is the empirical ğ‘ƒ -value corresponding to the association test of the best-fit PRS - this controls for the over-fitting that occurs when multiple thresholds are tested.</li>
</ol>
<p>For now, we can ignore most columns and focus on the <strong>PRS.R2</strong> and the <strong>P</strong> column, which provide information on the model fit.</p>
<p><img alt="Figue" src="/images/Day2.docxfolder/Height.gws_BARPLOT_2023-07-03.png" /></p>
<hr />
<blockquote>
<p>â“What is the R<sup>2</sup> for the PRS constructed using only genome-wide significant SNPs?
<details>
<summary>Answer</summary>     </p>
<p>0.071     </p>
</details>
<p>â“What is the P-value for the association between the PRS and the outcome? Is this significant? (explain your answer)
<details>
<summary>Answer</summary>     </p>
<p>1.36e-09     </p>
<p></details>
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h3 id="height-prs-across-multiple-p-value-thresholds">Height PRS across multiple P-value thresholds</h3>
<p>A disadvantage of using only genome-wide significant SNPs is that there are likely to be many true signals among the SNPs that did not reach genome-wide significance. However, since we do not know what ğ‘ƒ-value threshold provides the \"best\" prediction for our particular data, then we can calculate the PRS under several ğ‘ƒ-value thresholds and test their prediction accuracy to identify the \"best\" threshold (NB. See <a href="https://doi.org/10.1371/journal.pgen.1003348"><strong>Dudbridge, F 2013</strong></a> for theory on factors affecting the best-fit PRS)</p>
<blockquote></blockquote>
<p>This process is implemented in PRSice and can be performed automatically as follows:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --fastscore --out Results/Height.fast 
</code></pre></div></p>
<p>By removing the --bar-levels and --no-full command, we ask PRSice to perform PRS calculation with a number of predefined thresholds (0.001,0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 1). The <strong>.prsice</strong> file is very similar to the <strong>.summary</strong> file, the only difference is that <strong>.prsice</strong> file reports the results of model fits for <strong>all thresholds</strong> instead of the most predictive threshold. This allow us to observe the change in model fitting across different thresholds, visualized by the BARPLOT (<a href="#top"><a href="#_Figure-1.1">Figure 1.1</a></a>) generated by PRSice</p>
<blockquote>
<p><strong>Figure 1.1: BARPLOT generated by PRSice</strong> <br />
<img alt="Figure 1.1" src="/images/Day2.docxfolder/images-018.png" /></p>
</blockquote>
<hr />
<blockquote>
<p>â“Which is the most predictive threshold?
<details>
 <summary>Answer</summary>     </p>
<p>0.05     </p>
</details>
<p>â“What is the R<sup>2</sup> of the most predictive threshold and how does it compare to PRS generated using genome-wide significant SNPs?
<details> 
<summary>Answer</summary>     </p>
<p>0.26523     </p>
<p></details>
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h3 id="high-resolution-scoring">High Resolution Scoring</h3>
<p>If we limit ourselves to a small number of ğ‘ƒ-value thresholds, we might \"miss\" the most predictive threshold. In order to identify this \"best\" threshold, we will need \"high-resolution scoring\", that is, to test the predictive power of PRS generated under a larger number of p-value thresholds. We can achieve that by simply removing the --fastscore command from the PRSice script:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code> Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --out Results/Height.highres
</code></pre></div></p>
<p>When PRSice performs high-resolution scoring, it will generate a plot (<a href="#_bookmark15">Figure 1.2.1</a>) presenting the model fit of PRS calculated at all P-value thresholds.</p>
<blockquote>
<p><strong>Figure 1.2.1: High resolution Plot generated by PRSice</strong>
<img alt="Figure 1.2.1" src="/images/Day2.docxfolder/images-022.png" /></p>
</blockquote>
<p><strong>Figure 1.2.2: BARPLOT generated by PRSice</strong></p>
<p><img alt="Figure 1.2.2" src="/images/Day2.docxfolder/Height.highresBARPLOT2023-06-23.png" /> </p>
<hr />
<blockquote>
<p>â“Which is the most predictive threshold?
<details>
 <summary>Answer</summary>     </p>
<p>0.058   </p>
</details>
<p>â“How much better is the threshold identified using high-resolution scoring, in terms of model R<sup>2</sup>?
<details>
<summary>Answer</summary>     </p>
<p>The R<sup>2</sup> using high-resolution scoring is 0.268237. In this case, there is not significant difference between the two results.        </p>
</details>
<p>â“How does running fastscore vs high-resolution change the most predictive threshold identified?</p>
<p>â“The default of PRSice is to iterate the P-value threshold from \&lt; 5*Ã—*10<sup>âˆ’8</sup> to 0.5 with a step size of 0.00005, and to inlcude the P-value threshold of 1. Can you identify the commands controlling these parameters?
<details>
 <summary>Hint</summary>     </p>
<p>./Software/PRSice_linux -h</p>
<p></details>
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<p><strong>Accounting for Covariates</strong></p>
<p>When performing PRS, one might want to account for covariates. Based on user inputs, PRSice can automatically incorporate covariates into its model. For example, the following commands will include sex into the regression model as a covariate:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --cov Target_Data/TAR.covariate --cov-col Sex --out Results/Height.sex
</code></pre></div>
When covariates are included in the analysis, PRSice will use the model fit of <strong>only PRS</strong> for all its output. This ğ‘ƒğ‘…ğ‘†.ğ‘…<sup>2</sup> is calculated by substracting the ğ‘…<sup>2</sup> of the null model (e.g. ğ»ğ‘’ğ‘–ğ‘”â„ğ‘¡ <em>âˆ¼</em> ğ‘†ğ‘’ğ‘¥) from the ğ‘…<sup>2</sup> of the full model (e.g.ğ»ğ‘’ğ‘–ğ‘”â„ğ‘¡ <em>âˆ¼</em> ğ‘†ğ‘’ğ‘¥ + ğ‘ƒğ‘…ğ‘†)</p>
<hr />
<blockquote>
<p>â„¹ï¸ Usually, Principal Components (PCs) are also included as covariates in the analysis to account for population structure and it can be tedious to type all 20 or 40 PCs (e.g. <em>PC1</em>, <em>PC2</em>,...,<em>PC20</em>). In PRSice, you can add @ in front of the <em>--cov-col</em> string to activate the automatic substitution of numbers. If @ is found in front of the <em>--cov-col</em> string, any numbers within <strong>[</strong> and <strong>]</strong> will be parsed. E.g. @PC[1-3] will be read as <em>PC1</em>, <em>PC2</em>, <em>PC3</em>. Discontinuous input are also supported: @cov[1.3-5] will be parsed as <em>cov1</em>, <em>cov3</em>, <em>cov4</em>, <em>cov5</em>. You can also mix it up, e.g. @PC[1-3]. Sex will be interpreted as <em>PC1</em>, <em>PC2</em>, <em>PC3</em>, <em>Sex</em> by PRSice.
</p>
</blockquote>
<hr />
<blockquote>
<p>â“How does the inclusion of sex as covariate change the results?
<details>
 <summary>Answer</summary>     </p>
<p>The inclusion of sex as a covariate increased the phenotypic variance explained by both PRS and sex (FULL.R2 = 0.47)  </p>
<p></details>
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="stratifying-samples-by-prs">Stratifying Samples by PRS</h2>
<p>An interesting application of PRS is to test whether samples with higher PRS have higher phenotypic values. This can be nicely visualized using the quantile plot (<a href="#_bookmark16">Figure 1.3</a>)</p>
<p>To generate quantile plots in PRSice, simply add <em>--quantile 10</em> option.</p>
<hr />
<blockquote>
<p>ğŸ“œ We can skip the PRS calculation using the --plot option, which will use previoulsy calculated PRS to generate the plots
</p>
</blockquote>
<hr />
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --cov Target_Data/TAR.covariate --cov-col Sex --plot --quantile 10 --out Results/Height.sex
</code></pre></div>
<p><strong>Figure 1.3: Example of a quantile plot generated by PRSice</strong>
<img alt="Figure 1.3" src="/images/Day2.docxfolder/images-030.png" /></p>
<hr />
<blockquote>
<p>â„¹ï¸ The --plot option tells PRSice to generate the plots without re-running the whole PRSice analysis. This is handy when you want to change some of the parameters for plotting e.g. the number of quantiles. <strong>Try running the previous command with 20 quantiles, and again with 50 quantiles (checking the quantile plot each time</strong>.
</p>
</blockquote>
<hr />
<p>A disadvantage of the quantile plot is that it only separate samples into quantiles of equal size. However, it is sometimes interesting to investigate whether a specific strata (e.g. top 5% of samples),contain a higher PRS than the reference strata. For example, (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4754625/?report=reader"><strong>Mavaddat, N et al., 2015</strong></a>) found that samples in the highest 1% of PRS distribution have a 2.81 increased OR of breast cancer when comparing to samples at the middle quantiles (40th to 60th percentile). We can mimic their table by using <em>--quant-break</em>, which represents the upper bound of each strata, and <em>--quant-ref</em>, which represents the upper bound of the reference quantile:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/TAR.height --binary-target F --cov Target_Data/TAR.covariate --cov-col Sex --plot --quantile 100 --quant-break 1,5,10,20,40,60,80,90,95,99,100 --quant-ref 60 --out Results/Height.sex
</code></pre></div></p>
<p><strong>Figure 1.4: Example of a strata plot generated by PRSice</strong>
<img alt="Figure 1.4" src="/images/Day2.docxfolder/images-036.png" /></p>
<hr />
<blockquote>
<p>ğŸ“œ See the quantile results in Table from in the <em><em>QUANTILES</em></em> file, and the plots in the <em><em>QUANTILES_PLOT</em></em> file. Due to the small sample size of the target data the results here are underwhelming, but with high power we may observe strong deviation in the extreme quantiles.
</p>
</blockquote>
<hr />
<p><a href="#top"><a href="#table-of-contents">Back to Table of Contents</a></a></p>
<h2 id="case-control-studies">Case Control Studies</h2>
<p>In the previous exercises, we have performed PRS analyses on height, which is a quantitative trait. For binary phenotypes (e.g case-control) there are a number of differences in the analysis:</p>
<ol>
<li>Logistic regression has to be performed instead of linear regression</li>
<li>ORs are usually provided and need to be converted to ğ›½'s when
    constructing PRS</li>
</ol>
<p>Here, we will use CAD as an example. You will find the summary statistic under <em>Base_Data</em> (<strong>cad.add.txt</strong>) and the phenotype file (<strong>TAR.cad</strong>) under <em>Target_Data</em>. You will also need to specify <em>--binary-target T</em> in the PRSice command to indicate that the phenotype is binary.</p>
<hr />
<blockquote>
<p>â„¹ï¸ GWAS summary statistics for binary traits tend to report the OR instead of the ğ›½ coefficient, in which case the --or should be used. However, CARDIoGRAM plus C<sub>4</sub>D consortium provided the ğ›½ coefficient, therefore we will include --beta in our code and specify --binary-target T to indicate that the phenotype is binary.
</p>
</blockquote>
<hr />
<h2 id="rscript-prsiceprsicer-prsice-prsiceprsice_linux-base-base_datacadaddtxt-target-target_datatar-snp-markername-a1-effect_allele-a2-noneffect_allele-chr-chr-bp-bp_hg19-stat-beta-beta-pvalue-p_dgc-pheno-target_datacadpheno-binary-target-t-out-resultscadhighres"><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/cad.add.txt --target Target_Data/TAR --snp markername --A1 effect_allele --A2 noneffect_allele --chr chr --bp bp_hg19 --stat beta --beta --pvalue p_dgc --pheno Target_Data/CAD.pheno --binary-target T --out Results/CAD.highres
</code></pre></div></h2>
<blockquote>
<p>â„¹ï¸ --chr and --bp inform PRSice the columns containing the chromosomal coordinates. This enables PRSice to check whether the SNPs in the Base and Target data have the same chromosomal coordinate.
</p>
</blockquote>
<hr />
<p><strong>Figure 1.5: BARPLOT generated from PRSice</strong> 
<img alt="Figure 1.5" src="/images/Day2.docxfolder/CAD.highresBARPLOT2023-06-23.png" /></p>
<hr />
<blockquote>
<p>â“What is the R<sup>2</sup> and P-value of the best-fit PRS?
<details>
<summary>Answer</summary>     </p>
<p>0.39 and 0.001, respectively</p>
</details>
<p>â“Does this suggest that there is a significant association between the CAD PRS and CAD status in the target sample?
<details>
<summary>Answer</summary>     </p>
<p>The p-value does not suggest a significant association between the CAD PRS and CAD status.</p>
<p></details>
</p>
</blockquote>
<hr />
<h2 id="cross-trait-analysis">Cross-Trait Analysis</h2>
<p>A popular application of PRS is in performing cross-trait analyses. This allows some interesting analyses such as those performed by (<a href="https://www.nature.com/articles/mp2013138"><strong>Ruderfer, D et al., 2014</strong></a>) which used the bipolar PRS to predict into different clinical dimensions of schizophrenia.</p>
<p>In this practical, we will perform cross-trait analyses between CAD and Height, using height as the base and CAD as the target.</p>
<hr />
<blockquote>
<p>â„¹ï¸ We will only focus on the simplest form of cross-trait analysis in this practical. To perform the multi-phenotype cross-trait analysis similar to that of (<a href="https://www.nature.com/articles/mp2013138"><strong>Ruderfer, D et al., 2014</strong></a>), you can use the --pheno-col to include multiple target phenotype into the analysis.
</p>
</blockquote>
<hr />
<h2 id="rscript-prsiceprsicer-prsice-prsiceprsice_linux-base-base_datagiant_heighttxt-target-target_datatar-snp-markername-a1-allele1-a2-allele2-stat-b-beta-pvalue-p-pheno-target_datacadpheno-binary-target-t-out-resultscrosshighres"><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Rscript ~/PRSice/PRSice.R --prsice ~/PRSice/PRSice_linux --base Base_Data/GIANT_Height.txt --target Target_Data/TAR --snp MarkerName --A1 Allele1 --A2 Allele2 --stat b --beta --pvalue p --pheno Target_Data/CAD.pheno --binary-target T --out Results/Cross.highres
</code></pre></div></h2>
<p><strong>Figure 1.6: BARPLOT generated from PRSice</strong> 
<img alt="Figure 1.6" src="/images/Day2.docxfolder/Cross.highBARPLOT2023-06-23.png" /></p>
<blockquote>
<p>â“What is the R<sup>2</sup> for the most predictive threshold when using height as the base phenotype and CAD as the target phenotype?
<details>
<summary>Answer</summary>     </p>
<p>0.032</p>
</details>
<p>â“Now try using CAD as the base to predict height as the target trait? What is the PRS R<sup>2</sup> for that?
<details>
<summary>Answer</summary>     </p>
<p></details>
</p>
</blockquote>
<hr />
<p><a href="#top">Back to top</a></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/tadesouaiaia/sibArc-website" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../..";</script>
    <script src="../../../../js/theme_extra.js"></script>
    <script src="../../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="../../../../javascripts/details.js"></script>
      <script src="../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
